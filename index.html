<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8">
  <title>Hertz Motor Stok Takip v42</title>
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="p-4">
  <h1 class="text-xl font-bold">Hertz Motor Stok Takip (v42)</h1>
  <p>Bu sürüm Firebase RTDB ile anlık senkronizasyon için hazırlanmıştır.</p>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getDatabase, ref, onValue, update, set, onDisconnect } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAyx_HVYwckqw2bYl_sdu57XPUP_tdDsxA",
      authDomain: "hertz-stok-takip.firebaseapp.com",
      databaseURL: "https://hertz-stok-takip-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "hertz-stok-takip",
      storageBucket: "hertz-stok-takip.appspot.com",
      messagingSenderId: "512663727455",
      appId: "1:512663727455:web:99e15a20f7ae9b77a39aea"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const docId = new URLSearchParams(location.search).get("doc") || "varsayilan-stok-odasi";
    const rootRef = ref(db, `stok/${docId}`);

    let state = {products:[], logs:[]};

    function render(){
      document.body.insertAdjacentHTML("beforeend", `<div class='mt-2 text-sm text-slate-700'>Ürün sayısı: ${state.products.length}, Log sayısı: ${state.logs.length}</div>`);
    }

    window.firebasePush = (data) => {
      update(rootRef, { products:data.products, logs:data.logs, updatedAt:new Date().toISOString() });
    };

    onValue(rootRef, (snap)=>{
      const val = snap.val();
      if(val){
        state.products = val.products || [];
        state.logs = val.logs || [];
        render();
      }
    });
  </script>
</body>
</html>
